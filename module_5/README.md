module_5

Проект 5. Bank credit scoring

Цель проекта: 

Построение модели для прогнозирования вероятности дефолта заемщика.

Задачи проекта:

- EDA предоставленных данных
- Создание скоринговой модели
- Эксперименты с моделью
- Подбор гиперпараметров
- Получение предсказанных моделью значений для участие в соревновании на Kaggle

Описание датасета:

Исходный датасет состоит из 19 столбцов:

client_id - идентификатор клиента
education - уровень образования
sex - пол заёмщика
age - возраст заёмщика
car - флаг наличия автомобиля
car_type - флаг автомобиля-иномарки
decline_app_cnt - количество отказанных прошлых заявок
good_work - флаг наличия «хорошей» работы
bki_request_cnt - количество запросов в БКИ
home_address - категоризатор домашнего адреса
work_address - категоризатор рабочего адреса
income - доход заёмщика
foreign_passport - наличие загранпаспорта
sna - связь заемщика с клиентами банка
first_time - давность наличия информации о заемщике
score_bki - скоринговый балл по данным из БКИ
region_rating - рейтинг региона
app_date - дата подачи заявки
default - наличие дефолта (целевая переменная)

Что было сделано:

1) Проведен анализ структуры исходных данных.
2) Заполнены пропуски в категориальном признаке "education" с помощью функции 
пропорционального заполения пропусков в каждой категории.
3) Зменен признак "app_date" на "количество дней между самой ранней заявкой и текущей".
4) Числовые данные были очищены от выбросов.
5) Перекодированы в числовые категориальные и бинарные признки.
6) Категориальные признаки были разбиты на дамми переменные.
7) Проанализированы значимости переменных.
8) Обучены классификаторы: LogisticRegression, DecisionTreeClassifier, 
RandomForestClassifier.
9) Оучение проводилось на: 
 - необработанных исходных данных 
 - с oversampling методом SMOTE
 - с undersampling методом Tomek Links 
 - с undersampling методом простого урезания мажоритарного класса
 - на стандартизированных данных
 - на данных, очищенных от выбросов
10) Были определены оптимальные гиперпараметры для модели, показавшей лучшие
значения метрик.

Результаты:

1) Модели на необработанных признаках, со SMOTE  и Tomek Links не видят 
миноритарного класса.
2) Только undersampling методом простого урезания мажоритарного класса позволило
четко выделить миноритарный класс в логистической регресси.
3) Немного улучшили метрики стандартизация переменных и регуляризация.
4) Обучение на данных, очищенных от выбросов, ухудшило значения метрик.
5) Лучшие метрики, полученные в результате моделирования, таковы:
	TN			1272
	FP			615
	FN			580
	TP			1282
	accuracy	0.68	
	precision	0.68
	recall		0.69
	f1			0.68
	roc auc		0.74
6) Прогноз для тестовой выборки показал, что количество недефолтных клиентов 
превышает дефолтных в 2 раза. Тогда как, в обучающей выборке, где содержались 
реальные данные, соотношение было равно 7.

Это косвенно указывает на то, что модель далека от совершенства. 
Данное соотношение должно сохраняться. 
 